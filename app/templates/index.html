{% extends "base.html" %}

{% block content %}
    <div class="container">

        <script>
            tz = moment.tz.guess();
            zones = moment.tz.zonesForCountry('US');
            if (window.attachEvent) {
                window.attachEvent('onload', add_current_date);
            } else {
                if (window.onload) {
                    var curronload = window.onload;
                    var newonload = function (evt) {
                        curronload(evt);
                        add_current_date();
                    };
                    window.onload = newonload;
                } else {
                    window.onload = add_current_date;
                }
            }

            function add_current_date() {
                const elements = document.querySelectorAll('.btn-primary');
                for (let i = 0; i < elements.length; i++) {
                    elements[i].addEventListener('click', function (event) {
                        // Stop the link from redirecting
                        event.preventDefault();
                        // Redirect instead with JavaScript
                        const current_time = new Date()
                        const seconds = Math.round(current_time.getTime() / 1000);
                        const tz = moment.tz.guess();
                        window.location.href = elements[i].href + '?local_time=' + seconds + '&tz=' + tz;
                    }, false);
                }
            }
        </script>
        {% if regular_activities %}
            <div class="row">
                <h2 class="h3 mb-3 font-weight-normal">Which of these activities have you completed today?</h2>
            </div>
            <div class="row">
                {% for activity in regular_activities %}
                    <div class="col">
                        <a class="btn btn-primary btn-lg" role="button"
                           href="{{ url_for('main.log_activity', activity_id=activity.id) }}">{{ activity.title }} </a>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="row">
                <div class="col">
                    <p id="no_reg"> No regular activities. Please <a id="set_up"
                                                                     href="{{ url_for('main.add_regular_activity') }}">set
                        one up</a>.</p>
                </div>
            </div>
        {% endif %}
    </div>
{% endblock %}
